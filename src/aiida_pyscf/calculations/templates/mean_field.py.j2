# Section: Mean field
from pyscf import scf
mean_field = scf.{{ mean_field.method }}(structure)
{% if mean_field %}
    {% for key, value in mean_field.items() %}
        {% if key != 'method' %}
mean_field.{{ key }} = {{ value|render_python }}
        {% endif %}
    {% endfor %}
{% endif %}
mean_field_start = time.perf_counter()
mean_field_run = mean_field.run()

results['is_converged'] = mean_field_run.converged
results['timings']['mean_field'] = time.perf_counter() - mean_field_start
results['total_energy'] = mean_field_run.e_tot
results['forces'] = (- mean_field_run.nuc_grad_method().kernel()).tolist()
results['molecular_orbitals'] = {}
results['molecular_orbitals']['energies'] = mean_field_run.mo_energy.tolist()
results['molecular_orbitals']['labels'] = structure.ao_labels()
results['molecular_orbitals']['occupations'] = mean_field_run.mo_occ.tolist()
